"use client"
import React, { useEffect, useState } from "react";
import "./sideBar.css";

export const Sidebar = () => {
  const [isDarkMode, setIsDarkMode] = useState(true);

  const toggleTheme = () => {
    if (isDarkMode) {
      document.body.classList.add("light-theme");
    } else {
      document.body.classList.remove("light-theme");
    }
    setIsDarkMode(!isDarkMode);
  };

  const [activeSection, setActiveSection] = useState("main");

  const handleScroll = () => {
    const sections = ["main", "education", "experience", "contact"];
    const offsets = sections.map((id) => {
      const element = document.getElementById(id);
      return element ? element.offsetTop : 0;
    });

    const scrollPosition = window.scrollY + 100;
    for (let i = sections.length - 1; i >= 0; i--) {
      if (scrollPosition >= offsets[i]) {
        setActiveSection(sections[i]);
        break;
      }
    }
  };

  const handleClick = (section) => {
    setActiveSection(section);
    const element = document.getElementById(section);
    if (element) {
      element.scrollIntoView({ behavior: "smooth" });
    }
  };

  useEffect(() => {
    window.addEventListener("scroll", handleScroll);
    return () => window.removeEventListener("scroll", handleScroll);
  }, []);

  return (
    <div className="sideBar">
      <div className="sideBar-items">
        <div
          className={`sideBar-item ${activeSection === "main" ? "active" : ""}`}
          onClick={() => handleClick("main")}
        >
          <svg
            className="svg-icon"
            viewBox="0 0 20 22"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M2.5 19.4375H6.25V13.1875C6.25 12.8333 6.37 12.5367 6.61 12.2975C6.85 12.0583 7.14667 11.9383 7.5 11.9375H12.5C12.8542 11.9375 13.1512 12.0575 13.3912 12.2975C13.6312 12.5375 13.7508 12.8342 13.75 13.1875V19.4375H17.5V8.1875L10 2.5625L2.5 8.1875V19.4375ZM0 19.4375V8.1875C0 7.79167 0.0887498 7.41667 0.26625 7.0625C0.44375 6.70833 0.688333 6.41667 1 6.1875L8.5 0.5625C8.9375 0.229167 9.4375 0.0625 10 0.0625C10.5625 0.0625 11.0625 0.229167 11.5 0.5625L19 6.1875C19.3125 6.41667 19.5575 6.70833 19.735 7.0625C19.9125 7.41667 20.0008 7.79167 20 8.1875V19.4375C20 20.125 19.755 20.7137 19.265 21.2037C18.775 21.6937 18.1867 21.9383 17.5 21.9375H12.5C12.1458 21.9375 11.8492 21.8175 11.61 21.5775C11.3708 21.3375 11.2508 21.0408 11.25 20.6875V14.4375H8.75V20.6875C8.75 21.0417 8.63 21.3387 8.39 21.5787C8.15 21.8187 7.85333 21.9383 7.5 21.9375H2.5C1.8125 21.9375 1.22417 21.6929 0.735 21.2037C0.245833 20.7146 0.000833333 20.1258 0 19.4375Z" />
          </svg>
        </div>
        <div
          className={`sideBar-item ${
            activeSection === "education" ? "active" : ""
          }`}
          onClick={() => handleClick("education")}
        >
          <svg
            className="svg-icon"
            viewBox="0 0 20 20"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M10 1L0 5.82843L10 12.2662L14.7629 9.19995L10.2948 7.44105C10.2027 7.49786 10.102 7.52749 10 7.52778C9.81828 7.52778 9.644 7.43483 9.5155 7.26939C9.387 7.10394 9.31482 6.87955 9.31482 6.64557C9.31482 6.4116 9.387 6.18721 9.5155 6.02176C9.644 5.85631 9.81828 5.76337 10 5.76337L9.88669 6.23766L10.6805 6.55211L10.6809 6.5552L11.8523 7.01643L18.522 9.65859V10.3283C18.4297 10.4091 18.3542 10.5177 18.302 10.6446C18.2497 10.7716 18.2223 10.913 18.2222 11.0567C18.2223 11.2036 18.251 11.3482 18.3055 11.4773C18.36 11.6064 18.4388 11.7159 18.5345 11.7958C18.2226 13.3135 18.2222 16.7569 18.2222 18.1143C18.9074 18.6874 18.9074 18.7084 19.5926 18.1143C19.5926 16.7571 19.5922 13.3143 19.2804 11.7963C19.3762 11.7163 19.4549 11.6067 19.5094 11.4775C19.564 11.3483 19.5925 11.2036 19.5926 11.0566C19.5926 10.9128 19.5652 10.7712 19.513 10.644C19.4607 10.5169 19.3852 10.4082 19.2928 10.3273V8.92569L16.7523 7.91926L20 5.82843L10 1ZM4.15979 9.78844L3.59781 14.13C4.71873 14.3187 6.05959 15.1576 7.29224 16.1495C7.99327 16.7137 8.64989 17.333 9.18318 17.9338C9.50915 18.301 9.78173 18.6533 10 19C10.2183 18.6533 10.4908 18.301 10.8168 17.9338C11.3501 17.333 12.0067 16.7137 12.7078 16.1495C13.9404 15.1576 15.2813 14.3187 16.4022 14.13L15.8401 9.78844H15.5725L10 13.3759L4.42744 9.78844H4.15979Z" />
          </svg>
        </div>
        <div
          className={`sideBar-item ${
            activeSection === "experience" ? "active" : ""
          }`}
          onClick={() => handleClick("experience")}
        >
          <svg
            className="svg-icon"
            viewBox="0 0 26 23"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M2.93412 4.86852C2.86121 5.20926 2.86121 5.61852 2.86121 6.43519V12.963C2.86121 16.4546 2.86121 18.2009 4.08204 19.2852C5.30287 20.3694 7.26641 20.3704 11.1945 20.3704H15.3612C19.2893 20.3704 21.2539 20.3704 22.4737 19.2852C23.6935 18.2 23.6945 16.4546 23.6945 12.963V10.9241C23.6945 8.48704 23.6945 7.26759 22.8925 6.47593C22.8189 6.40287 22.741 6.33333 22.6591 6.26759C21.7685 5.55556 20.3966 5.55556 17.655 5.55556H17.2654C16.0643 5.55556 15.4633 5.55556 14.9029 5.41389C14.5953 5.33575 14.2989 5.22638 14.0195 5.08796C13.5112 4.83704 13.0862 4.45833 12.2362 3.7037L11.6633 3.19444C11.3779 2.94074 11.2362 2.81482 11.0862 2.7037C10.4411 2.22837 9.64968 1.93699 8.81537 1.86759C8.62162 1.85185 8.41954 1.85185 8.01746 1.85185C7.09766 1.85185 6.63829 1.85185 6.25496 1.91667C5.43187 2.05484 4.67475 2.41031 4.08236 2.93671C3.48997 3.46312 3.08982 4.13693 2.93412 4.86852ZM17.7393 2.77778C18.1195 2.77778 18.3102 2.77778 18.4706 2.7963C19.531 2.92593 20.3748 3.66944 20.5685 4.62963C20.4098 4.59798 20.2496 4.57295 20.0883 4.55463C19.4216 4.47685 18.58 4.47685 17.5362 4.47685H17.1883C16.207 4.47685 15.8341 4.47222 15.4956 4.38333C15.2985 4.33148 15.109 4.25906 14.931 4.16759C14.6227 4.01019 14.356 3.7713 13.6622 3.13241L13.2779 2.77778H17.7393ZM14.3195 8.56482C14.1123 8.56482 13.9136 8.63798 13.7671 8.76821C13.6206 8.89845 13.5383 9.07508 13.5383 9.25926C13.5383 9.44344 13.6206 9.62007 13.7671 9.75031C13.9136 9.88054 14.1123 9.9537 14.3195 9.9537H19.5279C19.7351 9.9537 19.9338 9.88054 20.0803 9.75031C20.2268 9.62007 20.3091 9.44344 20.3091 9.25926C20.3091 9.07508 20.2268 8.89845 20.0803 8.76821C19.9338 8.63798 19.7351 8.56482 19.5279 8.56482H14.3195Z"
            />
          </svg>
        </div>
        <div
          className={`sideBar-item ${
            activeSection === "contact" ? "active" : ""
          }`}
          onClick={() => handleClick("contact")}
        >
          <a href="#contact">
            <svg
              className="svg-icon"
              viewBox="0 0 21 21"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M4.33333 16.5556C4.33333 14.3333 8.77778 13.1111 11 13.1111C13.2222 13.1111 17.6667 14.3333 17.6667 16.5556V17.6667H4.33333M14.3333 7.66667C14.3333 8.55072 13.9821 9.39857 13.357 10.0237C12.7319 10.6488 11.8841 11 11 11C10.1159 11 9.2681 10.6488 8.64298 10.0237C8.01786 9.39857 7.66667 8.55072 7.66667 7.66667C7.66667 6.78261 8.01786 5.93477 8.64298 5.30964C9.2681 4.68452 10.1159 4.33333 11 4.33333C11.8841 4.33333 12.7319 4.68452 13.357 5.30964C13.9821 5.93477 14.3333 6.78261 14.3333 7.66667ZM1 3.22222V18.7778C1 19.3671 1.23413 19.9324 1.65087 20.3491C2.06762 20.7659 2.63285 21 3.22222 21H18.7778C19.3671 21 19.9324 20.7659 20.3491 20.3491C20.7659 19.9324 21 19.3671 21 18.7778V3.22222C21 2.63285 20.7659 2.06762 20.3491 1.65087C19.9324 1.23413 19.3671 1 18.7778 1H3.22222C2.63285 1 2.06762 1.23413 1.65087 1.65087C1.23413 2.06762 1 2.63285 1 3.22222Z" />
            </svg>
          </a>
        </div>
      </div>
      <div className="sideBar-options">
        {/* <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
          <path
            fill-rule="evenodd"
            clip-rule="evenodd"
            d="M4 0H6V2H10V4H8.86807C8.57073 5.66996 7.78574 7.17117 6.6656 8.35112C7.46567 8.73941 8.35737 8.96842 9.29948 8.99697L10.2735 6H12.7265L15.9765 16H13.8735L13.2235 14H9.77647L9.12647 16H7.0235L8.66176 10.9592C7.32639 10.8285 6.08165 10.3888 4.99999 9.71246C3.69496 10.5284 2.15255 11 0.5 11H0V9H0.5C1.5161 9 2.47775 8.76685 3.33437 8.35112C2.68381 7.66582 2.14629 6.87215 1.75171 6H4.02179C4.30023 6.43491 4.62904 6.83446 4.99999 7.19044C5.88743 6.33881 6.53369 5.23777 6.82607 4H0V2H4V0ZM12.5735 12L11.5 8.69688L10.4265 12H12.5735Z"
            fill="#000000"
          />
        </svg> */}

        {isDarkMode ? (
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            onClick={toggleTheme}
          >
            <path d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
          </svg>
        ) : (
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            className="size-6"
            onClick={toggleTheme}
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"
            />
          </svg>
        )}

        <a
          href="assets/CV/JuanIgnacioErrecartCV.pdf"
          download="Juan Ignacio Errecart CV"
        >
          <svg viewBox="0 0 19 18" xmlns="http://www.w3.org/2000/svg">
            <path d="M9.5 15L13.5 11L12.1 9.60001L10.5 11.2V7.00001H8.5V11.2L6.9 9.60001L5.5 11L9.5 15ZM2.5 18C1.95 18 1.47933 17.8043 1.088 17.413C0.696667 17.0217 0.500667 16.5507 0.5 16V3.52501C0.5 3.29167 0.537667 3.06667 0.613 2.85001C0.688333 2.63334 0.800667 2.43334 0.95 2.25001L2.2 0.725005C2.38333 0.491672 2.61233 0.312339 2.887 0.187005C3.16167 0.061672 3.44933 -0.000661376 3.75 5.291e-06H15.25C15.55 5.291e-06 15.8377 0.0626719 16.113 0.188005C16.3883 0.313339 16.6173 0.492339 16.8 0.725005L18.05 2.25001C18.2 2.43334 18.3127 2.63334 18.388 2.85001C18.4633 3.06667 18.5007 3.29167 18.5 3.52501V16C18.5 16.55 18.3043 17.021 17.913 17.413C17.5217 17.805 17.0507 18.0007 16.5 18H2.5ZM2.9 3.00001H16.1L15.25 2.00001H3.75L2.9 3.00001Z" />
          </svg>
        </a>
      </div>
    </div>
  );
};
